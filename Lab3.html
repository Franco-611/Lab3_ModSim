<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>lab3</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Lab3_files/libs/clipboard/clipboard.min.js"></script>
<script src="Lab3_files/libs/quarto-html/quarto.js"></script>
<script src="Lab3_files/libs/quarto-html/popper.min.js"></script>
<script src="Lab3_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Lab3_files/libs/quarto-html/anchor.min.js"></script>
<link href="Lab3_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Lab3_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Lab3_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Lab3_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Lab3_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<section id="lab-3-modelación-y-simulación" class="level1">
<h1>Lab 3 Modelación y Simulación</h1>
<section id="parte-2-numeros-aleatorios" class="level2">
<h2 class="anchored" data-anchor-id="parte-2-numeros-aleatorios">Parte 2 Numeros Aleatorios</h2>
<section id="tasks-1" class="level3">
<h3 class="anchored" data-anchor-id="tasks-1">Tasks 1</h3>
<p>Considere un experimento en el cual se cuentan cuántos carros pasan por una calle determinada dentro de un rango de tiempo dado. Sabemos que el tiempo de espera para el n-ésimo evento puede ser modelando a través de una variable gamma. Considere el caso en el que usted está esperando que pase el 3er carro en la calle dada. 1. Para diferentes lambdas en [2, 1, 0.5], grafique las distribuciones gamma para cada uno de los casos.</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> gamma</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>lambdas <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">1</span>, <span class="fl">0.5</span>]</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">20</span>, <span class="dv">1000</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> lam <span class="kw">in</span> lambdas:</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> gamma.pdf(x, lam)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    plt.plot(x, y, label<span class="op">=</span><span class="ss">f'lambda = </span><span class="sc">{</span>lam<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Tiempo de espera'</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'PDF'</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Distribución Gamma para diferentes lambdas'</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Lab3_files/figure-html/cell-2-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>¿Qué conclusiones puede obtener de las gráficas obtenidas en términos de los tiempos de espera y el número de ocurrencias del evento? ¿Qué relación existe entre el tiempo de espera y el número de ocurrencias de un evento?</p>
<ul>
<li><p>Esta gráfica lo que nos indica es la probabilidad de que un carro pase por una calle luego de cierto tiempo (en este caso 0.5, 1 y 2). Como se puede observar para un tiempo de espera de 0.5, la probabilidad de que de que ocurra el evento disminuye a medida que aumenta el tiempo de espera. Para un tiempo de espera de 1, ocurre lo mismo que con un lambda de 0.5 siendo esta que la probabilidad de que de que ocurra el evento disminuye a medida que aumenta el tiempo de espera. Pero pero la tasa de disminución es menor. Por último para un lambda de 2, la probabilidad de que ocurra el evento tiene una pequeña tendencia a aumentar inicialmente después de esperar un corto período de tiempo antes de disminuir gradualmente.</p></li>
<li><p>La relación que existe entre el tiempo de espera y el numero de ocurrencias de un evento se centra en que cuanto mayor sea el valor de lambda, es decir la probabilidad de que ocurra el evento. Más probable será que el evento ocurra pronto después de esperar un corto período de tiempo, y viceversa.</p></li>
</ul>
</section>
</section>
<section id="task-2" class="level2">
<h2 class="anchored" data-anchor-id="task-2">Task 2</h2>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generador1(size, semilla):</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> semilla</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    lista <span class="op">=</span> []</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(size):</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> (<span class="dv">5</span><span class="op">**</span><span class="dv">5</span> <span class="op">*</span> x) <span class="op">%</span> (<span class="dv">2</span><span class="op">**</span><span class="dv">35</span> <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>        lista.append(x <span class="op">/</span> (<span class="dv">2</span><span class="op">**</span><span class="dv">35</span> <span class="op">-</span> <span class="dv">1</span>))</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> lista</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generador2(size, semilla):</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> semilla</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    lista <span class="op">=</span> []</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(size):</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> (<span class="dv">7</span><span class="op">**</span><span class="dv">5</span> <span class="op">*</span> x) <span class="op">%</span> (<span class="dv">2</span><span class="op">**</span><span class="dv">31</span> <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>        lista.append(x <span class="op">/</span> (<span class="dv">2</span><span class="op">**</span><span class="dv">31</span> <span class="op">-</span> <span class="dv">1</span>))</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> lista</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generador3(size):</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [random.random() <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(size)]</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> histograma(data, label):</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    histograma <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> <span class="dv">10</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> value <span class="kw">in</span> data:</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>        index <span class="op">=</span> <span class="bu">int</span>(value <span class="op">*</span> <span class="dv">10</span>)</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>        histograma[index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    max_asteriscos <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>    max_count <span class="op">=</span> <span class="bu">max</span>(histograma)</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>    scale_factor <span class="op">=</span> max_count <span class="op">/</span> max_asteriscos</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>label<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>):</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>        range_str <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>i<span class="op">/</span><span class="dv">10</span><span class="sc">:.1f}</span><span class="ss">-</span><span class="sc">{</span>(i<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">10</span><span class="sc">:.1f}</span><span class="ss">:"</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>        asterisks <span class="op">=</span> <span class="st">"*"</span> <span class="op">*</span> <span class="bu">int</span>(histograma[i] <span class="op">/</span> scale_factor)</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>        percentage <span class="op">=</span> <span class="ss">f"(</span><span class="sc">{</span>histograma[i]<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>histograma[i] <span class="op">/</span> <span class="bu">len</span>(data) <span class="op">*</span> <span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%)"</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>range_str<span class="sc">.</span>ljust(<span class="dv">6</span>)<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>asterisks<span class="sc">.</span>ljust(<span class="dv">40</span>)<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>percentage<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>()</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>repeticiones <span class="op">=</span> [<span class="dv">100</span>, <span class="dv">5000</span>, <span class="dv">100000</span>]</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> n <span class="kw">in</span> repeticiones:</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>    data_list <span class="op">=</span> []</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>    generador <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>    data_1 <span class="op">=</span> generador1(n, <span class="dv">123</span>)</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>    data_2 <span class="op">=</span> generador2(n, <span class="dv">123</span>)</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>    data_3 <span class="op">=</span> generador3(n)</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>    histograma(data_1, <span class="ss">f"Generador 1 con </span><span class="sc">{</span>n<span class="sc">}</span><span class="ss"> repeticiones"</span>)</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>    histograma(data_2, <span class="ss">f"Generador 2 con </span><span class="sc">{</span>n<span class="sc">}</span><span class="ss"> repeticiones"</span>)</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>    histograma(data_3, <span class="ss">f"Generador 3 con </span><span class="sc">{</span>n<span class="sc">}</span><span class="ss"> repeticiones"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generador 1 con 100 repeticiones
0.0-0.1: ****************                         (11, 11.00%)
0.1-0.2: ************                             (8, 8.00%)
0.2-0.3: ************                             (8, 8.00%)
0.3-0.4: ***************                          (10, 10.00%)
0.4-0.5: ********************                     (13, 13.00%)
0.5-0.6: **********                               (7, 7.00%)
0.6-0.7: ***************                          (10, 10.00%)
0.7-0.8: ***************                          (10, 10.00%)
0.8-0.9: ***************                          (10, 10.00%)
0.9-1.0: ********************                     (13, 13.00%)

Generador 2 con 100 repeticiones
0.0-0.1: ***********                              (8, 8.00%)
0.1-0.2: ********************                     (14, 14.00%)
0.2-0.3: *****************                        (12, 12.00%)
0.3-0.4: ********                                 (6, 6.00%)
0.4-0.5: **************                           (10, 10.00%)
0.5-0.6: *****************                        (12, 12.00%)
0.6-0.7: ***********                              (8, 8.00%)
0.7-0.8: ************                             (9, 9.00%)
0.8-0.9: *****************                        (12, 12.00%)
0.9-1.0: ************                             (9, 9.00%)

Generador 3 con 100 repeticiones
0.0-0.1: **********                               (8, 8.00%)
0.1-0.2: ****************                         (12, 12.00%)
0.2-0.3: *************                            (10, 10.00%)
0.3-0.4: *************                            (10, 10.00%)
0.4-0.5: *****                                    (4, 4.00%)
0.5-0.6: *************                            (10, 10.00%)
0.6-0.7: ****************                         (12, 12.00%)
0.7-0.8: ****************                         (12, 12.00%)
0.8-0.9: ********************                     (15, 15.00%)
0.9-1.0: *********                                (7, 7.00%)

Generador 1 con 5000 repeticiones
0.0-0.1: ****************                         (473, 9.46%)
0.1-0.2: *****************                        (495, 9.90%)
0.2-0.3: *****************                        (498, 9.96%)
0.3-0.4: ********************                     (564, 11.28%)
0.4-0.5: ******************                       (514, 10.28%)
0.5-0.6: ******************                       (522, 10.44%)
0.6-0.7: ****************                         (460, 9.20%)
0.7-0.8: *****************                        (492, 9.84%)
0.8-0.9: ******************                       (513, 10.26%)
0.9-1.0: ****************                         (469, 9.38%)

Generador 2 con 5000 repeticiones
0.0-0.1: ******************                       (500, 10.00%)
0.1-0.2: *****************                        (477, 9.54%)
0.2-0.3: *******************                      (521, 10.42%)
0.3-0.4: *******************                      (512, 10.24%)
0.4-0.5: *****************                        (467, 9.34%)
0.5-0.6: ********************                     (535, 10.70%)
0.6-0.7: ******************                       (482, 9.64%)
0.7-0.8: ******************                       (490, 9.80%)
0.8-0.9: ******************                       (486, 9.72%)
0.9-1.0: *******************                      (530, 10.60%)

Generador 3 con 5000 repeticiones
0.0-0.1: *****************                        (471, 9.42%)
0.1-0.2: *****************                        (467, 9.34%)
0.2-0.3: *****************                        (476, 9.52%)
0.3-0.4: *******************                      (520, 10.40%)
0.4-0.5: *******************                      (525, 10.50%)
0.5-0.6: *******************                      (507, 10.14%)
0.6-0.7: ********************                     (533, 10.66%)
0.7-0.8: ******************                       (493, 9.86%)
0.8-0.9: *******************                      (527, 10.54%)
0.9-1.0: ******************                       (481, 9.62%)

Generador 1 con 100000 repeticiones
0.0-0.1: ******************                       (9513, 9.51%)
0.1-0.2: ******************                       (9902, 9.90%)
0.2-0.3: *******************                      (10050, 10.05%)
0.3-0.4: ********************                     (10482, 10.48%)
0.4-0.5: *******************                      (10004, 10.00%)
0.5-0.6: *******************                      (10203, 10.20%)
0.6-0.7: *******************                      (10101, 10.10%)
0.7-0.8: *******************                      (10161, 10.16%)
0.8-0.9: *******************                      (10123, 10.12%)
0.9-1.0: ******************                       (9461, 9.46%)

Generador 2 con 100000 repeticiones
0.0-0.1: *******************                      (10057, 10.06%)
0.1-0.2: *******************                      (9983, 9.98%)
0.2-0.3: *******************                      (9809, 9.81%)
0.3-0.4: *******************                      (10156, 10.16%)
0.4-0.5: *******************                      (9971, 9.97%)
0.5-0.6: ********************                     (10210, 10.21%)
0.6-0.7: *******************                      (10067, 10.07%)
0.7-0.8: *******************                      (9853, 9.85%)
0.8-0.9: *******************                      (9919, 9.92%)
0.9-1.0: *******************                      (9975, 9.98%)

Generador 3 con 100000 repeticiones
0.0-0.1: *******************                      (10049, 10.05%)
0.1-0.2: *******************                      (9991, 9.99%)
0.2-0.3: *******************                      (9975, 9.98%)
0.3-0.4: *******************                      (10025, 10.03%)
0.4-0.5: *******************                      (9974, 9.97%)
0.5-0.6: *******************                      (10009, 10.01%)
0.6-0.7: *******************                      (9916, 9.92%)
0.7-0.8: *******************                      (10010, 10.01%)
0.8-0.9: *******************                      (9996, 10.00%)
0.9-1.0: ********************                     (10055, 10.05%)
</code></pre>
</div>
</div>
<p>¿Qué generador le parece mejor? ¿Por qué? - Ambos generadores tienen resultados parecidos menos cuando se hace la grafica con 100 repeticiones ya que el segundo generador repite con mas frecuencia los numeros por lo que en ese caso sería mejor utilizar el primer generador.</p>
<section id="tasks-3" class="level3">
<h3 class="anchored" data-anchor-id="tasks-3">Tasks 3</h3>
<p>Considere la siguiente integral y responda 1. Transforme la integral a una con límites de 0 a 1, muestre su procedimiento 2. Aproxime la integral usando el método de Montecarlo, haciendo 100, 10,000 y 100,000 iteraciones.</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(y):</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">2</span><span class="op">*</span>(np.exp(<span class="op">-</span>((<span class="dv">1</span><span class="op">/</span>y<span class="op">-</span><span class="dv">1</span>))<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(y<span class="op">**</span><span class="dv">2</span>))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> montecarlo_integration(iterations):</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    integral_sum <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(iterations):</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> np.random.random()</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>        integral_sum <span class="op">+=</span> f(y)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    integral_approximation <span class="op">=</span> integral_sum <span class="op">/</span> iterations</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> integral_approximation</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>iterations_list <span class="op">=</span> [<span class="dv">100</span>, <span class="dv">10000</span>, <span class="dv">100000</span>]</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> iterations <span class="kw">in</span> iterations_list:</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    integral_approximation <span class="op">=</span> montecarlo_integration(iterations)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Aproximación con </span><span class="sc">{</span>iterations<span class="sc">}</span><span class="ss"> iteraciones: </span><span class="sc">{</span>integral_approximation<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Aproximación con 100 iteraciones: 1.816197912540806
Aproximación con 10000 iteraciones: 1.770479702771136
Aproximación con 100000 iteraciones: 1.7713768223295898</code></pre>
</div>
</div>
</section>
<section id="tasks-4" class="level3">
<h3 class="anchored" data-anchor-id="tasks-4">Tasks 4</h3>
<p>Considere la siguiente integral y responda 1. Transforme la integral múltiple a una en la que ambos límites sean de 0 a 1, muestre su procedimiento 2. Aproxime la integral usando el método de Montecarlo, haciendo 100, 10,000 y 100,000 iteraciones</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> g(t, z):</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.exp(<span class="op">-</span>(((<span class="dv">1</span><span class="op">/</span>t)<span class="op">-</span><span class="dv">1</span>)<span class="op">+</span>((<span class="dv">1</span><span class="op">/</span>t)<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>z))<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>t<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span>t<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> montecarlo_integration2(iterations):</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    integral_sum <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(iterations):</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>        t <span class="op">=</span> np.random.random()</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>        z <span class="op">=</span> np.random.random()</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>        integral_sum <span class="op">+=</span> g(t, z)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    integral_approximation <span class="op">=</span> integral_sum <span class="op">/</span> iterations</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> integral_approximation</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>iterations_list <span class="op">=</span> [<span class="dv">100</span>, <span class="dv">10000</span>, <span class="dv">100000</span>]</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> iterations <span class="kw">in</span> iterations_list:</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    integral_approximation <span class="op">=</span> montecarlo_integration2(iterations)</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Aproximación con </span><span class="sc">{</span>iterations<span class="sc">}</span><span class="ss"> iteraciones: </span><span class="sc">{</span>integral_approximation<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Aproximación con 100 iteraciones: 0.41517089623196685
Aproximación con 10000 iteraciones: 0.5007098741682866
Aproximación con 100000 iteraciones: 0.5006282530401279</code></pre>
</div>
</div>
</section>
</section>
<section id="parte-3---ejercicios-sobre-generacion-de-v.a-p1" class="level2">
<h2 class="anchored" data-anchor-id="parte-3---ejercicios-sobre-generacion-de-v.a-p1">Parte 3 - Ejercicios sobre Generacion de V.A P1</h2>
<section id="tasks-1-1" class="level3">
<h3 class="anchored" data-anchor-id="tasks-1-1">Tasks 1</h3>
<p>Genere muestras aleatorias a partir de una distribución geométrica utilizando el método de transformación inversa. 1. Defina una distribución geométrica objetivo con el parámetro p=0.3 2. Implemente el método de transformación inversa para generar muestras aleatorias a partir de la distribución geométrica. 3. Genere una muestra aleatoria de tamaño 1000 a partir de la distribución geométrica. 4. Trace un histograma de la muestra generada y compárelo con el PMF teórico de la distribución geométrica.</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> geom</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> geometrica_inversa(p, size):</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    u <span class="op">=</span> np.random.rand(size) </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> np.ceil(np.log(<span class="dv">1</span> <span class="op">-</span> u) <span class="op">/</span> np.log(<span class="dv">1</span> <span class="op">-</span> p))  </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> X.astype(<span class="bu">int</span>) </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="fl">0.3</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>size <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>sample <span class="op">=</span> geometrica_inversa(p, size)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>k_values <span class="op">=</span> np.arange(<span class="dv">1</span>, np.<span class="bu">max</span>(sample) <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>pmf_teorica <span class="op">=</span> geom.pmf(k_values, p)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>plt.hist(sample, bins<span class="op">=</span>np.<span class="bu">max</span>(sample), density<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">'blue'</span>, label<span class="op">=</span><span class="st">'Muestra Aleatoria'</span>)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>plt.stem(k_values, pmf_teorica, linefmt<span class="op">=</span><span class="st">'r--'</span>, markerfmt<span class="op">=</span><span class="st">'ro'</span>, basefmt<span class="op">=</span><span class="st">' '</span>, label<span class="op">=</span><span class="st">'PMF Teórica'</span>)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Valores'</span>)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Probabilidad'</span>)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Histograma de la muestra aleatoria y PMF teórica'</span>)</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Lab3_files/figure-html/cell-6-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="tasks-2" class="level3">
<h3 class="anchored" data-anchor-id="tasks-2">Tasks 2</h3>
<p>Genere muestras aleatorias a partir de una distribución de Poisson utilizando el método de rechazo. 1. Defina una distribución de Poisson objetivo con el parámetro λ = 3. 2. Elija una distribución de propuesta que sea fácil de muestrear, como una distribución uniforme o exponencial. 3. Calcule la constante C para acotar la relación entre el PMF objetivo y el PMF propuesto. 4. Implemente el método de rechazo para generar muestras aleatorias a partir de la distribución de Poisson. 5. Genere una muestra aleatoria de tamaño 1000 a partir de la distribución de Poisson. 6. Trace un histograma de la muestra generada y compárelo con el PMF teórico de la distribución de Poisson.</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> poisson, expon</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>lambda_poisson <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>poisson_dist <span class="op">=</span> poisson(lambda_poisson)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>lambda_exponential <span class="op">=</span> lambda_poisson</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>exponential_dist <span class="op">=</span> expon(scale<span class="op">=</span><span class="dv">1</span><span class="op">/</span>lambda_exponential)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>C <span class="op">=</span> poisson_dist.pmf(lambda_poisson) <span class="op">/</span> exponential_dist.pdf(lambda_poisson)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generar_muestra_poisson(n):</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    muestra <span class="op">=</span> []</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="bu">len</span>(muestra) <span class="op">&lt;</span> n:</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> np.floor(exponential_dist.rvs())</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>        u <span class="op">=</span> np.random.uniform(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> u <span class="op">&lt;</span> poisson_dist.pmf(x) <span class="op">/</span> (C <span class="op">*</span> exponential_dist.pdf(x)):</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>            muestra.append(x)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array(muestra)</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>tamano_muestra <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>muestra_poisson <span class="op">=</span> generar_muestra_poisson(tamano_muestra)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>valores_posibles <span class="op">=</span> np.arange(<span class="dv">0</span>, np.<span class="bu">max</span>(muestra_poisson) <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>pmf_teorico <span class="op">=</span> poisson_dist.pmf(valores_posibles)</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>plt.hist(muestra_poisson, bins<span class="op">=</span>np.arange(<span class="op">-</span><span class="fl">0.5</span>, np.<span class="bu">max</span>(muestra_poisson) <span class="op">+</span> <span class="fl">1.5</span>, <span class="dv">1</span>), density<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, label<span class="op">=</span><span class="st">'Muestra'</span>)</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>plt.stem(valores_posibles, pmf_teorico, linefmt<span class="op">=</span><span class="st">'r--'</span>, markerfmt<span class="op">=</span><span class="st">'ro'</span>, basefmt<span class="op">=</span><span class="st">'r-'</span>, label<span class="op">=</span><span class="st">'PMF teórico'</span>)</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Valores'</span>)</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Probabilidad'</span>)</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Histograma de la muestra generada y PMF teórico de la distribución de Poisson'</span>)</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Lab3_files/figure-html/cell-7-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Como se puede ver en el grafico anterior los valores generados de un principio si se estan apegando bastante al valor teorico de la distribucion de poisson sin embargo, a medida que se van generando mas valores estos se van alejando del valor teorico, esto se debe a que la muestra aún no ha convergido completamente hacia la distribución objetivo.</p>
</section>
<section id="tasks-3-1" class="level3">
<h3 class="anchored" data-anchor-id="tasks-3-1">Tasks 3</h3>
<p>Genere muestras aleatorias a partir de una distribución de probabilidad discreta personalizada mediante el método de aceptación-rechazo. 1. Defina una distribución de probabilidad discreta objetivo con valores y probabilidades especificados. a. Función = (x**2) / 55 2. Elija una distribución de propuesta con un soporte mayor que cubra el soporte de la distribución de destino. a. N.B: El “soporte” de una variable aleatoria o distribución de probabilidad se refiere al conjunto de valores para los cuales la variable aleatoria tiene una probabilidad distinta de cero. En otras palabras, es el rango de valores donde la distribución de probabilidad es positiva. 3. Calcule la constante C para acotar la relación entre el PMF objetivo y el PMF propuesto. 4. Implemente el método de aceptación-rechazo para generar muestras aleatorias a partir de la distribución discreta personalizada. 5. Genere una muestra aleatoria de tamaño 1000 a partir de la distribución personalizada. 6. Trace un histograma de la muestra generada y compárelo con el PMF objetivo.</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> pmf_objetivo(x):</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (x<span class="op">**</span><span class="dv">2</span>) <span class="op">/</span> <span class="dv">55</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">10</span> </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>distribucion_propuesta <span class="op">=</span> np.arange(<span class="dv">1</span>, N<span class="op">+</span><span class="dv">1</span>) </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>C <span class="op">=</span> <span class="bu">max</span>(pmf_objetivo(distribucion_propuesta) <span class="op">/</span> (<span class="dv">1</span><span class="op">/</span>N))</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generar_muestra_personalizada(n):</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    muestra <span class="op">=</span> []</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="bu">len</span>(muestra) <span class="op">&lt;</span> n:</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> np.random.choice(distribucion_propuesta) </span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>        u <span class="op">=</span> np.random.uniform(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> u <span class="op">&lt;</span> pmf_objetivo(x) <span class="op">/</span> (C <span class="op">*</span> (<span class="dv">1</span><span class="op">/</span>N)):</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>            muestra.append(x)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array(muestra)</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>tamano_muestra <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>muestra_personalizada <span class="op">=</span> generar_muestra_personalizada(tamano_muestra)</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>valores_posibles <span class="op">=</span> np.arange(<span class="dv">1</span>, N<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>pmf_teorico <span class="op">=</span> pmf_objetivo(valores_posibles)</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>plt.hist(muestra_personalizada, bins<span class="op">=</span>np.arange(<span class="fl">0.5</span>, N<span class="op">+</span><span class="fl">1.5</span>, <span class="dv">1</span>), density<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, label<span class="op">=</span><span class="st">'Muestra'</span>)</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>plt.stem(valores_posibles, pmf_teorico, linefmt<span class="op">=</span><span class="st">'r--'</span>, markerfmt<span class="op">=</span><span class="st">'ro'</span>, basefmt<span class="op">=</span><span class="st">'r-'</span>, label<span class="op">=</span><span class="st">'PMF teórico'</span>)</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Valores'</span>)</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Probabilidad'</span>)</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Histograma de la muestra generada y PMF teórico de la distribución personalizada'</span>)</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Lab3_files/figure-html/cell-8-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Como se puede observar en la gráfica anterior, los datos parecen presentar el comportamiento deseado pero a una menor escala. A pesar de esto el crecimiento no es lo suficientemente rápido como para ajustarse a la tendencia de la distribución personalizda.</p>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>